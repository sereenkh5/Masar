<!DOCTYPE html> <html lang="ar" dir="rtl"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>متجر إلكتروني متطور</title> <style> * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Arial', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; } .container { max-width: 1200px; margin: 0 auto; padding: 20px; } header { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 20px; margin-bottom: 30px; border: 1px solid rgba(255, 255, 255, 0.2); } .header-content { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; } h1 { color: white; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); } .cart-icon { background: rgba(255, 255, 255, 0.2); color: white; padding: 15px; border-radius: 50%; cursor: pointer; position: relative; transition: all 0.3s ease; border: 2px solid rgba(255, 255, 255, 0.3); } .cart-icon:hover { background: rgba(255, 255, 255, 0.3); transform: scale(1.1); } .cart-count { position: absolute; top: -5px; right: -5px; background: #ff4757; color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; } .filters-section { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 20px; margin-bottom: 30px; border: 1px solid rgba(255, 255, 255, 0.2); } .search-bar { display: flex; margin-bottom: 20px; } .search-bar input { flex: 1; padding: 15px; border: none; border-radius: 25px 0 0 25px; background: rgba(255, 255, 255, 0.9); font-size: 16px; outline: none; } .search-bar button { padding: 15px 25px; border: none; border-radius: 0 25px 25px 0; background: #2ecc71; color: white; cursor: pointer; transition: all 0.3s ease; } .search-bar button:hover { background: #27ae60; } .filters { display: flex; gap: 15px; flex-wrap: wrap; align-items: center; } .filter-group { display: flex; flex-direction: column; gap: 5px; } .filter-group label { color: white; font-size: 14px; font-weight: bold; } .filter-group select, .filter-group input { padding: 8px 12px; border: none; border-radius: 20px; background: rgba(255, 255, 255, 0.9); outline: none; font-size: 14px; } .loading { text-align: center; color: white; font-size: 18px; padding: 50px; } .error { background: rgba(231, 76, 60, 0.9); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; } .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; margin-bottom: 30px; } .product-card { background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 25px; text-align: center; transition: all 0.3s ease; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); } .product-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); } .product-image { width: 100%; height: 200px; background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%); border-radius: 15px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; font-size: 60px; color: white; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); position: relative; } .stock-badge { position: absolute; top: 10px; right: 10px; background: rgba(46, 204, 113, 0.9); color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: bold; } .low-stock { background: rgba(231, 76, 60, 0.9); } .product-title { font-size: 1.3em; margin-bottom: 10px; color: #2c3e50; font-weight: bold; } .product-description { color: #7f8c8d; margin-bottom: 15px; line-height: 1.5; } .product-price { font-size: 1.5em; font-weight: bold; color: #e74c3c; margin-bottom: 15px; } .product-category { background: #3498db; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; display: inline-block; margin-bottom: 15px; } .add-to-cart { background: linear-gradient(45deg, #3498db, #2980b9); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-size: 16px; font-weight: bold; transition: all 0.3s ease; } .add-to-cart:hover { background: linear-gradient(45deg, #2980b9, #3498db); transform: scale(1.05); } .add-to-cart:disabled { background: #95a5a6; cursor: not-allowed; transform: none; } .cart-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; } .cart-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 20px; padding: 30px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; } .cart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #ecf0f1; } .close-cart { background: #e74c3c; color: white; border: none; border-radius: 50%; width: 35px; height: 35px; cursor: pointer; font-size: 20px; } .cart-item { display: flex; align-items: center; justify-content: space-between; padding: 15px; margin-bottom: 15px; background: #f8f9fa; border-radius: 10px; } .cart-total { text-align: center; padding: 20px; background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; border-radius: 15px; margin-top: 20px; } .checkout-btn { background: #e74c3c; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-size: 18px; font-weight: bold; margin-top: 15px; transition: all 0.3s ease; } .checkout-btn:hover { background: #c0392b; transform: scale(1.05); } .quantity-controls { display: flex; align-items: center; gap: 10px; } .quantity-btn { background: #3498db; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-weight: bold; } .quantity-btn:hover { background: #2980b9; } .remove-item { background: #e74c3c; color: white; border: none; padding: 8px 15px; border-radius: 15px; cursor: pointer; } .remove-item:hover { background: #c0392b; } .customer-form { background: #f8f9fa; padding: 20px; border-radius: 15px; margin-top: 20px; } .form-group { margin-bottom: 15px; } .form-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #2c3e50; } .form-group input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; } .stats-section { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 15px; padding: 20px; margin-bottom: 30px; border: 1px solid rgba(255, 255, 255, 0.2); color: white; } .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; } .stat-card { background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px; text-align: center; } .stat-number { font-size: 2em; font-weight: bold; margin-bottom: 5px; } .stat-label { font-size: 14px; opacity: 0.8; } @media (max-width: 768px) { .header-content { text-align: center; } h1 { font-size: 2em; margin-bottom: 15px; } .filters { flex-direction: column; align-items: stretch; } .products-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; } .cart-content { width: 95%; padding: 20px; } } </style> </head> <body> <div class="container"> <header> <div class="header-content"> <h1>🛍️ متجري الإلكتروني المتطور</h1> <div class="cart-icon" onclick="openCart()"> 🛒 <span class="cart-count" id="cartCount">0</span> </div> </div> </header> <!-- قسم الإحصائيات --> <div class="stats-section" id="statsSection" style="display: none;"> <h3 style="margin-bottom: 20px;">📊 إحصائيات المتجر</h3> <div class="stats-grid" id="statsGrid"> <!-- الإحصائيات ستظهر هنا --> </div> </div> <!-- قسم الفلاتر والبحث --> <div class="filters-section"> <div class="search-bar"> <input type="text" id="searchInput" placeholder="ابحث عن المنتجات..." onkeyup="handleSearch()"> <button onclick="searchProducts()">🔍 بحث</button> </div> <div class="filters"> <div class="filter-group"> <label>الفئة:</label> <select id="categoryFilter" onchange="applyFilters()"> <option value="">جميع الفئات</option> </select> </div> <div class="filter-group"> <label>السعر الأدنى:</label> <input type="number" id="minPrice" placeholder="0" onchange="applyFilters()"> </div> <div class="filter-group"> <label>السعر الأعلى:</label> <input type="number" id="maxPrice" placeholder="∞" onchange="applyFilters()"> </div> <div class="filter-group"> <label>ترتيب بحسب:</label> <select id="sortBy" onchange="applyFilters()"> <option value="">بدون ترتيب</option> <option value="price_asc">السعر: من الأقل للأعلى</option> <option value="price_desc">السعر: من الأعلى للأقل</option> <option value="name_asc">الاسم: أ-ي</option> <option value="name_desc">الاسم: ي-أ</option> </select> </div> <button onclick="clearFilters()" style="background: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;"> مسح الفلاتر </button> <button onclick="toggleStats()" style="background: #9b59b6; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;"> عرض الإحصائيات </button> </div> </div> <!-- رسائل التحميل والأخطاء --> <div id="loading" class="loading" style="display: none;"> 🔄 جاري تحميل المنتجات... </div> <div id="error" class="error" style="display: none;"> ❌ حدث خطأ في تحميل البيانات. يرجى المحاولة مرة أخرى. </div> <main> <div class="products-grid" id="productsGrid"> <!-- المنتجات ستُحمل هنا --> </div> </main> </div> <!-- نافذة سلة المشتريات --> <div class="cart-modal" id="cartModal"> <div class="cart-content"> <div class="cart-header"> <h2>🛒 سلة المشتريات</h2> <button class="close-cart" onclick="closeCart()">×</button> </div> <div id="cartItems"> <!-- عناصر السلة ستظهر هنا --> </div> <div class="cart-total" id="cartTotal"> المجموع الكلي: 0 ريال </div> <!-- نموذج بيانات العميل --> <div class="customer-form"> <h3 style="margin-bottom: 15px; color: #2c3e50;">بيانات العميل</h3> <div class="form-group"> <label>الاسم الكامل:</label> <input type="text" id="customerName" placeholder="أدخل اسمك الكامل" required> </div> <div class="form-group"> <label>البريد الإلكتروني:</label> <input type="email" id="customerEmail" placeholder="example@email.com" required> </div> <div class="form-group"> <label>رقم الهاتف:</label> <input type="tel" id="customerPhone" placeholder="05xxxxxxxx" required> </div> <div class="form-group"> <label>العنوان:</label> <input type="text" id="customerAddress" placeholder="عنوانك الكامل" required> </div> </div> <button class="checkout-btn" onclick="checkout()">إتمام الطلب 💳</button> </div> </div> <script> // إعدادات API const API_BASE_URL = 'http://localhost:3000/api'; // متغيرات عامة let allProducts = []; let cart = JSON.parse(localStorage.getItem('cart')) || []; let currentFilters = {}; // تحميل البيانات عند بدء التطبيق window.onload = async function() { await loadProducts(); await loadCategories(); updateCartDisplay(); }; // تحميل المنتجات من الخادم async function loadProducts() { try { showLoading(true); hideError(); const response = await fetch(${API_BASE_URL}/products); if (!response.ok) { throw new Error('فشل في تحميل المنتجات'); } const result = await response.json(); allProducts = result.data || []; displayProducts(allProducts); } catch (error) { console.error('خطأ في تحميل المنتجات:', error); showError('فشل في تحميل المنتجات. يرجى التأكد من تشغيل الخادم على localhost:3000'); } finally { showLoading(false); } } // تحميل الفئات للفلتر async function loadCategories() { const categories = [...new Set(allProducts.map(p => p.category))]; const categoryFilter = document.getElementById('categoryFilter'); categories.forEach(category => { const option = document.createElement('option'); option.value = category; option.textContent = category; categoryFilter.appendChild(option); }); } // عرض/إخفاء رسالة التحميل function showLoading(show) { document.getElementById('loading').style.display = show ? 'block' : 'none'; } // عرض/إخفاء رسالة الخطأ function showError(message) { const errorDiv = document.getElementById('error'); if (message) { errorDiv.textContent = message; errorDiv.style.display = 'block'; } else { hideError(); } } function hideError() { document.getElementById('error').style.display = 'none'; } // عرض المنتجات function displayProducts(products) { const grid = document.getElementById('productsGrid'); grid.innerHTML = ''; if (products.length === 0) { grid.innerHTML = <div style="grid-column: 1 / -1; text-align: center; padding: 50px; color: white; font-size: 18px;"> 🔍 لم يتم العثور على منتجات مطابقة للبحث </div> ; return; } products.forEach(product => { const productCard = document.createElement('div'); productCard.className = 'product-card'; const stockBadgeClass = product.stock < 5 ? 'low-stock' : ''; const isOutOfStock = product.stock === 0; productCard.innerHTML = <div class="product-image"> ${product.emoji} <div class="stock-badge ${stockBadgeClass}"> ${isOutOfStock ? 'نفد المخزون' : متوفر: ${product.stock}} </div> </div> <div class="product-category">${product.category}</div> <h3 class="product-title">${product.name}</h3> <p class="product-description">${product.description}</p> <div class="product-price">${product.price} ريال</div> <button class="add-to-cart" onclick="addToCart(${product.id})" ${isOutOfStock ? 'disabled' : ''}> ${isOutOfStock ? 'نفد المخزون ❌' : 'إضافة للسلة 🛒'} </button> ; grid.appendChild(productCard); }); } // إضافة منتج للسلة function addToCart(productId) { const product = allProducts.find(p => p.id === productId); if (!product || product.stock === 0) { alert('عذراً، هذا المنتج غير متوفر حالياً'); return; } const existingItem = cart.find(item => item.id === productId); if (existingItem) { if (existingItem.quantity >= product.stock) { alert(عذراً، لا يمكن إضافة أكثر من ${product.stock} قطع من هذا المنتج); return; } existingItem.quantity++; } else { cart.push({...product, quantity: 1}); } updateCartDisplay(); saveCart(); // تأثير بصري const button = event.target; const originalText = button.textContent; const originalBg = button.style.background; button.style.background = '#2ecc71'; button.textContent = 'تم الإضافة ✅'; setTimeout(() => { button.style.background = originalBg; button.textContent = originalText; }, 1000); } // تحديث عرض السلة function updateCartDisplay() { const cartCount = document.getElementById('cartCount'); const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0); cartCount.textContent = totalItems; updateCartModal(); } // تحديث نافذة السلة function updateCartModal() { const cartItems = document.getElementById('cartItems'); const cartTotal = document.getElementById('cartTotal'); if (cart.length === 0) { cartItems.innerHTML = '<p style="text-align: center; padding: 50px; color: #7f8c8d;">السلة فارغة 🛒</p>'; } else { cartItems.innerHTML = cart.map(item => <div class="cart-item"> <div> <span style="font-size: 30px; margin-left: 15px;">${item.emoji}</span> <strong>${item.name}</strong> <div style="color: #7f8c8d; font-size: 14px;">${item.price} ريال للقطعة</div> </div> <div class="quantity-controls"> <button class="quantity-btn" onclick="changeQuantity(${item.id}, -1)">-</button> <span style="margin: 0 10px; font-weight: bold;">${item.quantity}</span> <button class="quantity-btn" onclick="changeQuantity(${item.id}, 1)">+</button> <button class="remove-item" onclick="removeFromCart(${item.id})">حذف</button> </div> </div> ).join(''); } const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0); cartTotal.innerHTML = المجموع الكلي: <strong>${total} ريال</strong>; } // تغيير كمية المنتج function changeQuantity(productId, change) { const item = cart.find(item => item.id === productId); const product = allProducts.find(p => p.id === productId); if (item && product) { const newQuantity = item.quantity + change; if (newQuantity <= 0) { removeFromCart(productId); } else if (newQuantity > product.stock) { alert(عذراً، لا يمكن إضافة أكثر من ${product.stock} قطع من هذا المنتج); } else { item.quantity = newQuantity; updateCartDisplay(); saveCart(); } } } // حذف منتج من السلة function removeFromCart(productId) { cart = cart.filter(item => item.id !== productId); updateCartDisplay(); saveCart(); } // البحث والفلترة async function searchProducts() { const searchTerm = document.getElementById('searchInput').value.trim(); if (searchTerm) { try { showLoading(true); const response = await fetch(${API_BASE_URL}/search?q=${encodeURIComponent(searchTerm)}); const result = await response.json(); if (result.success) { displayProducts(result.data); } else { showError('حدث خطأ في البحث'); } } catch (error) { console.error('خطأ في البحث:', error); showError('حدث خطأ في البحث'); } finally { showLoading(false); } } else { displayProducts(allProducts); } } // البحث أثناء الكتابة function handleSearch() { const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim(); if (searchTerm === '') { applyFilters(); return; } const filteredProducts = allProducts.filter(product => product.name.toLowerCase().includes(searchTerm) || product.description.toLowerCase().includes(searchTerm) || product.category.toLowerCase().includes(searchTerm) ); displayProducts(filteredProducts); } // تطبيق الفلاتر function applyFilters() { let filteredProducts = [...allProducts]; // فلتر الفئة const category = document.getElementById('categoryFilter').value; if (category) { filteredProducts = filteredProducts.filter(p => p.category === category); } // فلتر السعر const minPrice = document.getElementById('minPrice').value; const maxPrice = document.getElementById('maxPrice').value; if (minPrice) { filteredProducts = filteredProducts.filter(p => p.price >= parseFloat(minPrice)); } if (maxPrice) { filteredProducts = filteredProducts.filter(p => p.price <= parseFloat(maxPrice)); } // الترتيب const sortBy = document.getElementById('sortBy').value; if (sortBy) { const [field, direction] = sortBy.split('_'); filteredProducts.sort((a, b) => { let aValue = a[field]; let bValue = b[field]; if (typeof aValue === 'string') { aValue = aValue.toLowerCase(); bValue = bValue.toLowerCase(); } if (direction === 'desc') { return bValue > aValue ? 1 : -1; } return aValue > bValue ? 1 : -1; }); } displayProducts(filteredProducts); } // مسح الفلاتر function clearFilters() { document.getElementById('searchInput').value = ''; document.getElementById('categoryFilter').value = ''; document.getElementById('minPrice').value = ''; document.getElementById('maxPrice').value = ''; document.getElementById('sortBy').value = ''; displayProducts(allProducts); } // عرض/إخفاء الإحصائيات async function toggleStats() { const statsSection = document.getElementById('statsSection'); const isVisible = statsSection.style.display !== 'none'; if (isVisible) { statsSection.style.display = 'none'; } else { await loadStats(); statsSection.style.display = 'block'; } } // تحميل الإحصائيات async function loadStats() { try { const response = await fetch(${API_BASE_URL}/stats); const result = await response.json(); if (result.success) { displayStats(result.data); } } catch (error) { console.error('خطأ في تحميل الإحصائيات:', error); } } // عرض الإحصائيات function displayStats(stats) { const statsGrid = document.getElementById('statsGrid'); statsGrid.innerHTML = <div class="stat-card"> <div class="stat-number">${stats.totalProducts}</div> <div class="stat-label">إجمالي المنتجات</div> </div> <div class="stat-card"> <div class="stat-number">${stats.totalOrders}</div> <div class="stat-label">إجمالي الطلبات</div> </div> <div class="stat-card"> <div class="stat-number">${stats.totalRevenue} ريال</div> <div class="stat-label">إجمالي المبيعات</div> </div> <div class="stat-card"> <div class="stat-number">${stats.averageOrderValue} ريال</div> <div class="stat-label">متوسط قيمة الطلب</div> </div> ; // عرض المنتجات قليلة المخزون if (stats.lowStockProducts && stats.lowStockProducts.length > 0) { const lowStockDiv = document.createElement('div'); lowStockDiv.style.gridColumn = '1 / -1'; lowStockDiv.innerHTML = <h4 style="margin-bottom: 10px; color: #e74c3c;">⚠️ منتجات قليلة المخزون:</h4> <div style="display: flex; flex-wrap: wrap; gap: 10px;"> ${stats.lowStockProducts.map(p => <span style="background: rgba(231, 76, 60, 0.1); color: #e74c3c; padding: 5px 10px; border-radius: 15px; font-size: 14px;"> ${p.name} (${p.stock}) </span> ).join('')} </div> ; statsGrid.appendChild(lowStockDiv); } } // فتح نافذة السلة function openCart() { document.getElementById('cartModal').style.display = 'block'; updateCartModal(); } // إغلاق نافذة السلة function closeCart() { document.getElementById('cartModal').style.display = 'none'; } // إتمام الطلب async function checkout() { if (cart.length === 0) { alert('السلة فارغة!'); return; } // التحقق من بيانات العميل const customerName = document.getElementById('customerName').value.trim(); const customerEmail = document.getElementById('customerEmail').value.trim(); const customerPhone = document.getElementById('customerPhone').value.trim(); const customerAddress = document.getElementById('customerAddress').value.trim(); if (!customerName || !customerEmail || !customerPhone || !customerAddress) { alert('يرجى ملء جميع بيانات العميل'); return; } try { const orderData = { items: cart.map(item => ({ id: item.id, quantity: item.quantity })), customerInfo: { name: customerName, email: customerEmail, phone: customerPhone, address: customerAddress } }; const response = await fetch(${API_BASE_URL}/orders, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(orderData) }); const result = await response.json(); if (result.success) { alert(تم إتمام الطلب بنجاح! 🎉\nرقم الطلب: ${result.data.id}\nالمجموع: ${result.data.totalAmount} ريال); // تنظيف البيانات cart = []; updateCartDisplay(); saveCart(); closeCart(); // مسح بيانات النموذج document.getElementById('customerName').value = ''; document.getElementById('customerEmail').value = ''; document.getElementById('customerPhone').value = ''; document.getElementById('customerAddress').value = ''; // تحديث المنتجات لإظهار المخزون الجديد await loadProducts(); } else { alert('حدث خطأ: ' + result.message); } } catch (error) { console.error('خطأ في إتمام الطلب:', error); alert('حدث خطأ في إتمام الطلب. يرجى المحاولة مرة أخرى.'); } } // حفظ السلة في التخزين المحلي function saveCart() { localStorage.setItem('cart', JSON.stringify(cart)); } // إغلاق النافذة المودال بالنقر خارجها document.getElementById('cartModal').onclick = function(event) { if (event.target === this) { closeCart(); } }; // البحث بالضغط على Enter document.getElementById('searchInput').addEventListener('keyup', function(event) { if (event.key === 'Enter') { searchProducts(); } }); </script> </body> </html>